dontaudit surfaceflinger kernel:system module_request;
allow surfaceflinger vendor_file:file read;
#for hdmi
allow surfaceflinger sysfs_hdmi:file rw_file_perms;
allow surfaceflinger surfaceflinger:unix_stream_socket { ioctl };
allow surfaceflinger system_data_file:dir create_dir_perms;
allow surfaceflinger gpu_device:chr_file { ioctl };
allow surfaceflinger gpu_device:dir { search rw_dir_perms };
allow surfaceflinger self:capability { sys_nice };
allow surfaceflinger gpu_file:file rw_file_perms;

typeattribute surfaceflinger system_executes_vendor_violators;
allow surfaceflinger graphics_file:file { read open getattr execute };
#allow surfaceflinger sysfs:file rw_file_perms;

typeattribute surfaceflinger system_writes_vendor_properties_violators;
get_prop(surfaceflinger,public_vendor_system_prop)
set_prop(surfaceflinger,public_vendor_system_prop)
